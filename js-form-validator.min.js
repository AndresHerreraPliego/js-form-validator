(function(r){var t="validate formatString destroy reload getFormHandle getFields showErrors hideErrors".split(" "),n=function(b,c,d){b.JsValidator=this;this.settings={onAir:!0,showErrors:!0,autoHideErrors:!1,autoHideErrorsTimeout:2E3,locale:"en",messages:{},rules:{},errorClassName:"error",removeSpaces:!1,autoTracking:!0,eventsList:["keyup","change","blur"]};var e=this;this.formHandle=b||null;this.submitCallback=c||null;this.fields=this.getFields(this.formHandle.querySelectorAll("[data-rule]"));this.applySettings(d||
{});this.submitCallback=this.submitCallback.bind(this);this._eventChangeWithDelay=this._eventChangeWithDelay.bind(this);this._eventChange=this._eventChange.bind(this);this._eventSubmit=this._eventSubmit.bind(this);this.submitCallback&&this.eventsBuilder("addEventListener");this.settings.autoTracking&&"MutationObserver"in window&&(new MutationObserver(function(b){[].forEach.call(b,function(b){switch(b.type){case "subtree":case "childList":var c=!1,d=[];[].forEach.call(b.addedNodes,function(b){d=b.querySelectorAll("*");
-1!==["SELECT","INPUT","TEXTAREA","CHECKBOX","RADIOBUTTON"].indexOf(b.tagName)&&(c=!0);!c&&[].forEach.call(d,function(b){-1!==["SELECT","INPUT","TEXTAREA","CHECKBOX","RADIOBUTTON"].indexOf(b.tagName)&&(c=!0)})});c&&e.reload()}})})).observe(this.formHandle,{childList:!0,subtree:!0});return this};n.prototype={messages:{en:{required:{empty:"This field is required",incorrect:"Incorrect value"},notzero:{empty:"Please make a selection",incorrect:"Incorrect value"},integer:{empty:"Enter an integer value",
incorrect:"Incorrect integer value"},"float":{empty:"Enter an float number",incorrect:"Incorrect float"},min:{empty:"Enter more",incorrect:"Enter more"},max:{empty:"Enter less",incorrect:"Enter less"},between:{empty:"Enter the between {0}-{1}",incorrect:"Enter the between {0}-{1}"},name:{empty:"Please, enter your name",incorrect:"Incorrect name"},lastname:{empty:"Please, enter your lastname",incorrect:"Incorrect lastname"},phone:{empty:"Please, enter the phone number",incorrect:"Incorrect phone number"},
email:{empty:"Please, enter your email address",incorrect:"Incorrect email address"},length:{empty:"Please, Enter a minimum of {0} characters and a maximum of {1}",incorrect:"Incorrect. Enter a minimum of {0} characters and a maximum of {1}"},minlength:{empty:"Please, enter at least {0} characters",incorrect:"You have entered less than {0} characters"},maxlength:{empty:"Please, enter at maximum {0} characters",incorrect:"You have entered more than {0} characters"},maxfilesize:{empty:"The size of one or more selected files larger than {0} {1}",
incorrect:"The size of one or more selected files larger than {0} {1}"},fileextension:{empty:"Select file",incorrect:"One or more files have an invalid type"}}},rules:{required:function(b){return""!==b},notzero:function(b){return 0<parseInt(b,10)},integer:function(b){return(new RegExp(/^[0-9]+$/gi)).test(b)},"float":function(b){b=b.toString().replace(/,/,".");return this.integer(b)||(new RegExp(/^([0-9])+(\.)([0-9]+$)/gi)).test(b)},min:function(b,c){return this["float"](b)?parseFloat(b)>=parseFloat(c[0]):
parseInt(b,10)>=parseInt(c[0],10)},max:function(b,c){return this["float"](b)?parseFloat(b)<=parseFloat(c[0]):parseInt(b,10)<=parseInt(c[0],10)},between:function(b,c){c[1]=c[1]||999999;return this["float"](b)?parseFloat(b)>=parseFloat(c[0])&&parseFloat(b)<=parseFloat(c[1]):this.integer(b)?parseInt(b,10)>=parseInt(c[0],10)&&parseInt(b,10)<=parseInt(c[1],10):!1},name:function(b){return 0<b.length&&2>b.length?!1:(new RegExp(/^[a-zA-Z\s\u0430-\u044f\u0410-\u042f\u0451\u0401\-]+$/g)).test(b)},lastname:function(b){return this.name(b)},
phone:function(b){return b.replace(/[^0-9]+/gi,"").match(/[0-9]+/gi)&&6>b.replace(/[^0-9]+/gi,"").match(/[0-9]+/gi)[0].length?!1:(new RegExp(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d?)\)?)?[\-\. \\\/]?)?((?:\(?\d{1,}\)?[\-\. \\\/]?){0,})(?:[\-\. \\\/]?(?:#|ext\.?|extension|x)[\-\. \\\/]?(\d+))?$/g)).test(b)},email:function(b){return(new RegExp(/^(("[\w-\s]+")|([\w\-]+(?:\.[\w\-]+)*)|("[\w-\s]+")([\w\-]+(?:\.[\w\-]+)*))(@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i)).test(b)},
length:function(b,c){return this.between(b.replace(/\s{2,}/g," ").length,c)},maxlength:function(b,c){return this.max(b.replace(/\s{2,}/g," ").length,c)},minlength:function(b,c){return this.min(b.replace(/\s{2,}/g," ").length,c)},maxfilesize:function(b,c){var d,e=b.length,f=1;switch(c[1].toLowerCase()){case "b":f=1;break;case "kb":f=1024;break;case "mb":f=1048576;break;case "gb":f=1073741824;break;case "tb":f=1099511627776}for(d=0;d<e;d+=1)if(parseFloat(b[d])>parseFloat(c[0])*f)return!1;return!0},
fileextension:function(b,c){var d,e,f=c.length,h=b.length,k=0;for(d=0;d<f;d+=1)for(e=0;e<h;e+=1)c[d]===b[e].split(".").pop()&&(k+=1);return b.length===k?!0:!1}},orderFields:function(b,c){var d=this,e={};b&&c&&Object.keys(this.fields).forEach(function(f){d.fields[f].handle[b]&&d.fields[f].handle[b]===c&&(e[f]=d.fields[f])});return e},_eventSubmit:function(b){b.preventDefault();this.hideErrors(!1,!0);!this.validate()&&this.showErrors();!0===this.submitCallback(this.errors||null,this.errors?!1:!0)&&
this.formHandle.submit()},_eventChange:function(b){var c=this;this.settings.removeSpaces&&(new RegExp(/\s{2,}/g)).test(b.target.value)&&(b.target.value=b.target.value.replace(/\s{2,}/g," "));if("radio"===b.target.type){var d=this.orderFields("name",b.target.name);Object.keys(d).forEach(function(b){c.hideErrors(d[b].handle)})}else this.hideErrors(b.target);this.validate(b.target)||(this.showErrors(b.target),!this.settings.showErrors&&this.submitCallback(this.errors,!1))},_eventChangeWithDelay:function(b){var c=
this;this.intervalID&&clearTimeout(this.intervalID);this.intervalID=setTimeout(function(){c._eventChange.apply(c,[b])},400)},applySettings:function(b){var c=this;b.rules&&Object.keys(b.rules).forEach(function(d){c.rules[d]=b.rules[d]});b.messages&&Object.keys(b.messages).forEach(function(d){Object.keys(b.messages[d]).forEach(function(e){Object.keys(b.messages[d][e]).forEach(function(f){c.settings.messages[d]=c.settings.messages[d]||{};c.settings.messages[d][e]=c.settings.messages[d][e]||{};c.settings.messages[d][e][f]=
b.messages[d][e][f]})})});Object.keys(b).forEach(function(b){c.settings[b]=c.settings[b]});return this},getFields:function(b){var c={},d=[],e=[];b=b||this.formHandle.querySelectorAll("[data-rule]");Object.keys(b).forEach(function(f){d=b[f].getAttribute("data-rule").split("|");Object.keys(d).forEach(function(b){d[b].match(/-/gi)?(e=d[b].split("-"),d[b]=e[0],e=e.splice(1),d[b]=[d[b],e]):d[b]=[d[b],[]]});c[f]={name:b[f].getAttribute("name"),rules:d,defaultValue:b[f].getAttribute("data-default"),handle:b[f],
intervalID:null}});return c},validate:function(b){var c=this,d=b?this.getFields([b]):this.fields,e,f,h,k,g,l,m=null;this.errors=this.errors?null:this.errors;Object.keys(d).forEach(function(b){e=!0;d[b].rules&&Object.keys(d[b].rules).forEach(function(n){f=d[b].rules[n][0];h=d[b].rules[n][1];k=d[b].defaultValue;g=d[b].handle.value;switch(d[b].handle.type){case "checkbox":!d[b].handle.checked&&(g="");break;case "radio":var p=c.orderFields("name",d[b].handle.name),q=!1;Object.keys(p).forEach(function(b){p[b].handle.checked&&
(q=!0)});q||(Object.keys(p).forEach(function(b){try{l=c.settings.messages[c.settings.locale][f].empty}catch(v){l=c.messages[c.settings.locale][f].empty}}),g="");break;case "file":d[b].handle.files&&d[b].handle.files.length&&(g=[],Object.keys(d[b].handle.files).forEach(function(c){switch(f){case "maxfilesize":g.push(d[b].handle.files[c].size);break;case "fileextension":g.push(d[b].handle.files[c].name)}}))}if(e&&(""!==g||d[b].rules.join("|").match(/\|{0,1}required\|{0,1}/)))if(e&&k&&g!==k?(e=!1,m=
"incorrect"):e&&c.rules[f]&&!c.rules[f](g,h)&&(""===g?(e=!1,m="empty"):(e=!1,m="incorrect")),e)c.hideErrors(d[b].handle,!0);else{c.errors=c.errors||{};try{try{l=c.settings.messages[c.settings.locale][f][m]}catch(u){l=c.messages[c.settings.locale][f][m]}}catch(u){f="required",l=c.messages[c.settings.locale][f][m]}!h.length&&h.push(g);c.errors[b]={name:d[b].name,errorText:c.formatString(l,h)};c.submitCallback||(c.errors[b].handle=d[b].handle)}})});return this.submitCallback?this.errors?!1:!0:this.errors||
!0},hideErrors:function(b,c){var d=this,e;Object.keys(this.fields).forEach(function(f){if(b&&b===d.fields[f].handle||!b)e=d.fields[f].handle.nextElementSibling,c&&d.fields[f].handle.classList.remove(d.settings.errorClassName),e&&"validator-error"===e.getAttribute("data-type")&&e.parentNode.removeChild(e)})},showErrors:function(b){var c=this,d,e=function(b,e){b.classList.add(c.settings.errorClassName);b.nextElementSibling&&"validator-error"===b.nextElementSibling.getAttribute("data-type")||!c.settings.showErrors||
(d=document.createElement("div"),d.setAttribute("class",c.settings.errorClassName),d.setAttribute("data-type","validator-error"),d.innerHTML=e.errorText,b.parentNode.insertBefore(d,b.nextSibling))};Object.keys(this.errors).forEach(function(d){b?Object.keys(c.fields).forEach(function(f){c.fields[f].handle.getAttribute("name")===b.getAttribute("name")&&e(c.fields[f].handle,c.errors[d])}):("0"===d||0<d&&c.fields[d].name!==c.fields[d-1].name)&&e(c.fields[d].handle,c.errors[d])});this.settings.autoHideErrors&&
(b?(b.intervalID&&clearTimeout(b.intervalID),this.intervalID||(b.intervalID=setTimeout(function(){b.intervalID=null;c.hideErrors(b)},this.settings.autoHideErrorsTimeout))):(this.intervalID&&clearTimeout(this.intervalID),this.intervalID=setTimeout(function(){c.intervalID=null;c.hideErrors(!1)},this.settings.autoHideErrorsTimeout)))},getFormHandle:function(){return this.formHandle},formatString:function(b,c){return b.replace(/\{(\d+)\}/gi,function(b,e){return b&&c[e]?c[e]:""})},destroy:function(){this.hideErrors(!1,
!0);this.eventsBuilder("removeEventListener")},reload:function(b,c){this.destroy();switch(arguments.length){case 2:this.submitCallback=b;this.settings=c;break;case 1:this.settings=b}this.fields=this.getFields(this.formHandle.querySelectorAll("[data-rule]"));this.submitCallback&&this.eventsBuilder("addEventListener");this.applySettings(c||{})},eventsBuilder:function(b){var c=this;this.formHandle[b]("submit",this._eventSubmit);this.settings.onAir&&Object.keys(this.fields).forEach(function(d){[].forEach.call(c.settings.eventsList,
function(e){if("keyup"===e)c.fields[d].handle[b](e,c._eventChangeWithDelay);else c.fields[d].handle[b](e,c._eventChange)})})}};r.Validator=function(){var b=function(b,c){function d(){return b.apply(this,c)}d.prototype=b.prototype;return new d}(n,a),c=function(){};c.prototype={};[].forEach.call(t,function(d){c.prototype[d]=function(){return b[d].apply(b,a)}});return new c(a)}})(this);